<style>
    .info-box {
        border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .info-box-text {
        text-transform: none;
    }

    .info-box:hover .info-box-icon {
        font-size: 60px;
    }

    .info-box-text-sm {
        font-size: 12px;
        font-style: normal;
    }

    .info-box-text-italic {
        font-size: 14px;
        font-style: italic;
        font-weight: normal;
    }

    .text-blod {
        text-indent:35px; /*缩进*/
        font-weight: bold;
    }

    .title-sm {
        font-weight: normal;
        margin-left: 10px;
    }
</style>
<section class="content-header" >
    <h1>
        综合<small>信息</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="${basePath}"><i class="fa fa-dashboard"></i> 首页</a></li>
        <li class="active">综合信息</li>
    </ol>
</section>
<section class="content">
    <!-- Info boxes -->
    <a name="top"></a>
    <div class="row">
        <!--信息块3-->
        <div class="col-md-4">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">当日异常情况</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <label class="text-blod" style="">异常总数：15次</label>
                    </div>
                    <div class="row">
                        <label class="text-blod">异常企业：3家</label>
                    </div>
                    <div class="row">
                        <label class="text-blod">异常类型：4类</label>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块3 END-->

        <!--信息块4-->
        <div class="col-md-4">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">当日情况</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <label class="text-blod" style="">风机报警：7次</label>
                    </div>
                    <div class="row">
                        <label class="text-blod">门窗报警：6次</label>
                    </div>
                    <div class="row">
                        <label class="text-blod">炉膛报警：2次</label>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块4 END-->

        <!--信息块5-->
        <div class="col-md-4">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">报警信息</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <label class="text-blod" style="">15:45 中嘉华宸能源有限公司<span color="red">【风机报警】</span></label>
                    </div>
                    <div class="row">
                        <label class="text-blod" style="">10:23 平湖人民电镀塑料制品厂<span color="red">【风机报警】</span></label>
                    </div>
                    <div class="row">
                        <label class="text-blod" style="">09:01 平湖市民星纺织品有限责任公司<span color="red">【炉膛报警】</span></label>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块5 END-->
    </div>

    <!--第四大块-->
    <a name="top"></a>
    <div class="row">


        <!--信息块1-->
        <div class="col-md-6">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">GIS</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <div id="milkMap" style="margin-left:8px;width:98%;height: 400px"></div>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块1 END-->

        <!--信息块2-->
        <div class="col-md-6">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">月度分析</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <div id="demo02" style="width:100%;height: 400px"></div>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块2 END-->
    </div>
    <!--第四大块 END-->

    <!--第三大块-->
    <a name="top"></a>
    <div class="row">
        <!--信息块1-->
        <div class="col-md-6">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">年度分析</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <div id="demo01" style="width:100%;height: 400px"></div>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块1 END-->

        <!--信息块1-->
        <div class="col-md-6">
            <div class="box box-info">
                <div class="box-header">
                    <h3 class="box-title">当月报警</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <a type="button" class="btn btn-box-tool" href="#top" title="回到顶部"><i class="fa fa-arrow-up"></i></a>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="row">
                        <div id="demo04_01" style="width:100%;height: 500px"></div>
                    </div>
                    <!-- /.row -->
                </div>
                <!-- ./box-body -->
            </div>
        </div>
        <!--信息块1 END-->

    </div>
    <!--第三大块 END-->







</section>


<script>
    /*信息块1*/
    var option = {
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'cross',
                crossStyle: {
                    color: '#999'
                }
            }
        },
        toolbox: {
            feature: {
                dataView: {show: true, readOnly: false},
                magicType: {show: true, type: ['line', 'bar']},
                restore: {show: true},
                saveAsImage: {show: true}
            }
        },
        legend: {
            data:['异常数','正常数']
        },
        xAxis: [
            {
                type: 'category',
                data: ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'],
                axisPointer: {
                    type: 'shadow'
                }
            }
        ],
        yAxis: [
            {
                type: 'value',
                name: '数量',
                min: 0,
                max: 250,
                interval: 50,
                axisLabel: {
                    formatter: '{value} 次'
                }
            }
        ],
        series: [
            {
                name:'异常数',
                type:'bar',
                data:[50, 49, 70, 23, 25, 76, 135, 162, 32, 20, 64, 33]
            },
            {
                name:'正常数',
                type:'bar',
                data:[76, 59, 90, 26, 28, 70, 175, 182, 48, 18, 60, 23]
            }
        ]
    };
    // 基于准备好的dom，初始化echarts实例
    echarts.init(document.getElementById('demo01')).setOption(option);
    /*信息块1 END*/



    /*信息块2*/
    var option2 = {
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'cross',
                crossStyle: {
                    color: '#999'
                }
            }
        },
        toolbox: {
            feature: {
                dataView: {show: true, readOnly: false},
                magicType: {show: true, type: ['line', 'bar']},
                restore: {show: true},
                saveAsImage: {show: true}
            }
        },
        legend: {
            data:['异常数','正常数']
        },
        xAxis: [
            {
                type: 'category',
                data: ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30'],
                axisPointer: {
                    type: 'shadow'
                }
            }
        ],
        yAxis: [
            {
                type: 'value',
                name: '数量',
                min: 0,
                max: 250,
                interval: 50,
                axisLabel: {
                    formatter: '{value} 次'
                }
            }
        ],
        series: [
            {
                name:'异常数',
                type:'line',
                data:[50, 49, 70, 23, 25, 76, 135, 162, 32, 20, 64, 33,50, 49, 70, 23, 25, 76, 135, 162, 32, 20, 64, 33,50, 49, 70, 23, 25]
            },
            {
                name:'正常数',
                type:'line',
                data:[76, 59, 90, 26, 28, 70, 175, 182, 48, 18, 60, 23, 23, 25, 76, 135, 162,182, 48, 18, 60, 23,23, 25, 76, 135, 162,182, 70, 175]
            }
        ]
    };
    // 基于准备好的dom，初始化echarts实例
    echarts.init(document.getElementById('demo02')).setOption(option2);
    /*信息块2 END*/





    /*日历图*/
    var cellSize = [80, 80];
    var pieRadius = 30;

    function getVirtulData() {
        var date = +echarts.number.parseDate('2019-05-01');
        var end = +echarts.number.parseDate('2019-06-01');
        var dayTime = 3600 * 24 * 1000;
        var data = [];
        for (var time = date; time < end; time += dayTime) {
            data.push([
                echarts.format.formatTime('yyyy-MM-dd', time),
                Math.floor(Math.random() * 10000)
            ]);
        }
        return data;
    }

    function getPieSeries(scatterData, chart) {
        return echarts.util.map(scatterData, function (item, index) {
            var center = chart.convertToPixel('calendar', item);
            return {
                id: index + 'pie',
                type: 'pie',
                center: center,
                label: {
                    normal: {
                        formatter: '{c}',
                        position: 'inside'
                    }
                },
                radius: pieRadius,
                data: [
                    {name: '风机报警', value: Math.round(Math.random() * 24)},
                    {name: '门窗报警', value: Math.round(Math.random() * 24)},
                    {name: '炉膛报警', value: Math.round(Math.random() * 24)}
                ]
            };
        });
    }

    function getPieSeriesUpdate(scatterData, chart) {
        return echarts.util.map(scatterData, function (item, index) {
            var center = chart.convertToPixel('calendar', item);
            return {
                id: index + 'pie',
                center: center
            };
        });
    }

    var scatterData = getVirtulData();

    var option4_01 = {
        tooltip : {},
        legend: {
            data: ['风机报警', '门窗报警', '炉膛报警'],
            bottom: 20
        },
        calendar: {
            top: 'middle',
            left: 'center',
            orient: 'vertical',
            cellSize: cellSize,
            yearLabel: {
                show: false,
                textStyle: {
                    fontSize: 30
                }
            },
            dayLabel: {
                margin: 20,
                firstDay: 1,
                nameMap: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六']
            },
            monthLabel: {
                show: false
            },
            range: ['2019-05']
        },
        series: [{
            id: 'label',
            type: 'scatter',
            coordinateSystem: 'calendar',
            symbolSize: 1,
            label: {
                normal: {
                    show: true,
                    formatter: function (params) {
                        return echarts.format.formatTime('dd', params.value[0]);
                    },
                    offset: [-cellSize[0] / 2 + 10, -cellSize[1] / 2 + 10],
                    textStyle: {
                        color: '#000',
                        fontSize: 14
                    }
                }
            },
            data: scatterData
        }]
    };

    var myChart = echarts.init(document.getElementById('demo04_01'));
    myChart.setOption(option4_01);
    myChart.setOption({
        series: getPieSeries(scatterData, myChart)
    });


</script>

<!--百度地图-->

<script type="text/javascript">
    var map = new BMap.Map("milkMap");          // 创建地图实例 allmap,milkMap


    var point = new BMap.Point(121.09595,30.73155);  // 创建点坐标
    //var point = new BMap.Point(120.169542,30.259352);  // 创建点坐标
    map.centerAndZoom(point, 12);                 // 初始化地图，设置中心点坐标和地图级别


    //地图类型只有
    //地图(BMAP_NORMAL_MAP)和三维(BMAP_PERSPECTIVE_MAP)
    //卫星(BMAP_SATELLITE_MAP)和混合(BMAP_HYBRID_MAP)，共4种
    map.setMapType(BMAP_NORMAL_MAP);
    map.addControl(new BMap.MapTypeControl());   //添加地图类型控件 (地图，卫星，三维)


    //设置行政边界
    // function getBoundary(){
    /*var bdary = new BMap.Boundary();

     bdary.get('平湖市', function(rs){       //获取行政区域
     // map.clearOverlays();        //清除地图覆盖物
     var count = rs.boundaries.length; //行政区域的点有多少个
     for(var i = 0; i < count; i++){
     var ply = new BMap.Polygon(rs.boundaries[i], {strokeWeight: 2, strokeColor: "#ff0000"}); //建立多边形覆盖物
     map.addOverlay(ply);  //添加覆盖物
     map.setViewport(ply.getPath());    //调整视野
     }
     });   */
    // }




    //地图类型只有
    //地图(BMAP_NORMAL_MAP)和三维(BMAP_PERSPECTIVE_MAP)
    //卫星(BMAP_SATELLITE_MAP)和混合(BMAP_HYBRID_MAP)，共4种
    //map.setMapType(BMAP_SATELLITE_MAP);

    //map.setCurrentCity("杭州市");  //设置当前城市

    map.enableScrollWheelZoom();        //开启滚轮缩放功能
    map.disableDoubleClickZoom();       //关闭双击放大功能
    map.enableKeyboard();               //开启键盘操作功能
    map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
    //map.addControl(new BMap.MapTypeControl());   //添加地图类型控件 (地图，卫星，三维)





    // 编写自定义函数,创建标注
    function addMarker(marker,label){
        map.addOverlay(marker);               // 将标注添加到地图中
        marker.setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画
        //var label = new BMap.Label("标注",{offset:new BMap.Size(20,-10)});
        marker.setLabel(label);
        marker.addEventListener("click",getAttr);//

    }

    function getAttr(){
        var p = marker.getPosition();       //获取marker的位置
        alert("marker的位置是" + p.lng + "," + p.lat);
    }


    //******************************************添加控件和比例尺******************************************
    var top_left_control = new BMap.ScaleControl({anchor: BMAP_ANCHOR_TOP_LEFT});// 左上角，添加比例尺
    var top_left_navigation = new BMap.NavigationControl();  //左上角，添加默认缩放平移控件
    var top_right_navigation = new BMap.NavigationControl({anchor: BMAP_ANCHOR_TOP_RIGHT, type: BMAP_NAVIGATION_CONTROL_SMALL}); //右上角，仅包含平移和缩放按钮
    /*缩放控件type有四种类型:
     BMAP_NAVIGATION_CONTROL_SMALL：仅包含平移和缩放按钮；BMAP_NAVIGATION_CONTROL_PAN:仅包含平移按钮；
     BMAP_NAVIGATION_CONTROL_ZOOM：仅包含缩放按钮*/

    function add_control(){
        map.addControl(top_left_control);
        map.addControl(top_left_navigation);
        map.addControl(top_right_navigation);
    }
    //移除控件和比例尺
    function delete_control(){
        map.removeControl(top_left_control);
        map.removeControl(top_left_navigation);
        map.removeControl(top_right_navigation);
    }


    $.extend({
        csv: function (url, f) {
            $.get(url, function (record) {
                //按回车拆分
                record = record.split(/\n/);
                //第一行标题
                var title = record[0].split(",");
                //删除第一行
                record.shift();
                var data = [];
                for (var i = 0; i < record.length; i++) {
                    var t = record[i].split(",");
                    for (var y = 0; y < t.length; y++) {
                        if (!data[i]) data[i] = {};
                        data[i][title[y]] = t[y];
                    }
                }
                f.call(this, data);
                data = null;
            });
        }
    })

//    var basePath = "${basePath}";
    $.csv(basePath+"/resources/external/baidu.csv", function (data) {
        //console.log(data);
        $.each(data, function(i, d) {
            var marker;
            if(d.status>0){
                var myIcon = new BMap.Icon(basePath+"/resources/adminlte/dist/img//address1.png", new BMap.Size(48,48));
                var point = new BMap.Point(d.long,d.lat);
                marker = new BMap.Marker(point,{icon:myIcon});  // 创建标注
            }else{
                //var point = new BMap.Point(d.long,d.lat);
                //marker = new BMap.Marker(point);  // 创建标注
                var myIcon = new BMap.Icon(basePath+"/resources/adminlte/dist/img//address2.png", new BMap.Size(48,48));
                var point = new BMap.Point(d.long,d.lat);
                marker = new BMap.Marker(point,{icon:myIcon});  // 创建标注
            }

            // addMarker(marker);
            var infoWindow = new BMap.InfoWindow(d.name);  // 创建信息窗口对象
            map.addOverlay(marker);
            marker.addEventListener("click", function(){
                this.openInfoWindow(infoWindow);
                //图片加载完毕重绘infowindow
                document.getElementById('imgDemo').onload = function (){
                    infoWindow.redraw();   //防止在网速较慢，图片未加载时，生成的信息框高度比图片的总高度小，导致图片部分被隐藏
                }
            });
        });
    });



    // ******************************************随机向地图添加25个标注******************************************
    /*var bounds = map.getBounds();
     var sw = bounds.getSouthWest();
     var ne = bounds.getNorthEast();
     var lngSpan = Math.abs(sw.lng - ne.lng);
     var latSpan = Math.abs(ne.lat - sw.lat);
     for (var i = 0; i < 25; i ++) {
     var point = new BMap.Point(sw.lng + lngSpan * (Math.random() * 0.7), ne.lat - latSpan * (Math.random() * 0.7));
     var marker = new BMap.Marker(point);  // 创建标注
     addMarker(marker);
     }*/

    //******************************************单击获取点击的经纬度******************************************
    map.addEventListener("click",function(e){
        //alert(e.point.lng + "," + e.point.lat);
        document.getElementById("text").value=e.point.lng + "," + e.point.lat;
    });

</script>

